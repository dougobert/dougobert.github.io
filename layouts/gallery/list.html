{{/*
  Gallery List Template
  Renders all sub-galleries in content/gallery/ as a grid
*/}}
{{ define "main" }}
<link rel="stylesheet" href="/css/gallery-grid.css">

<nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-list">
    <li><a href="{{ .Site.Home.RelPermalink }}">Home</a></li>
    <li>/</li>
    <li><a href="{{ (site.GetPage "section" "gallery").RelPermalink }}">Gallery</a></li>
    {{ if ne .RelPermalink ((site.GetPage "section" "gallery").RelPermalink) }}
      <li>/</li>
      <li aria-current="page">{{ .Title }}</li>
    {{ end }}
  </ol>
</nav>
<div class="photo-gallery">
  {{ range .Pages }}
    {{ $p := . }}
    {{ with $p.Resources.Match "*.jpg" }}
      {{ $img := index . 0 }}
      {{ $webp := $img.Process "webp" }}
      {{ $thumb := $webp.Fit "400x400" }}
      <a class="gallery-item" href="{{ $p.RelPermalink }}">
        <img class="gallery-thumb" src="{{ $thumb.RelPermalink }}" alt="{{ $p.Title }} thumbnail" loading="lazy">
        <div class="gallery-title">{{ $p.Title }}</div>
      </a>
    {{ else }}
      <a class="gallery-item" href="{{ $p.RelPermalink }}">
        <div class="gallery-thumb gallery-thumb-placeholder">No image</div>
        <div class="gallery-title">{{ $p.Title }}</div>
      </a>
    {{ end }}
  {{ end }}
</div>

{{ end }}