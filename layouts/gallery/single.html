{{ define "main" }}

<link rel="stylesheet" href="https://unpkg.com/photoswipe@5/dist/photoswipe.css">
<script src="https://unpkg.com/photoswipe@5/dist/photoswipe-lightbox.esm.min.js" type="module"></script>

<nav aria-label="Breadcrumb" class="breadcrumb-nav" style="margin-bottom:1rem;">
  <ol style="list-style:none;display:flex;flex-wrap:wrap;padding:0;margin:0;">
    <li><a href="{{ .Site.Home.RelPermalink }}">Home</a></li>
    <li style="margin:0 0.5em;">/</li>
    <li><a href="{{ (site.GetPage "section" "gallery").RelPermalink }}">Gallery</a></li>
    {{ with .CurrentSection }}
      <li style="margin:0 0.5em;">/</li>
      <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
    {{ end }}
    <li style="margin:0 0.5em;">/</li>
    <li aria-current="page">{{ .Title }}</li>
  </ol>
</nav>
<article>

  <h1 class="page-header">{{ .Title }}</h1>
  {{ with .Resources.Match "*.jpg" }}
    {{ $img := index . 0 }}
    {{ $thumb := $img.Fit "800x800" }}
    <div class="pswp-gallery">
      <a
        href="{{ $img.RelPermalink }}"
        data-pswp-width="{{ $img.Width }}"
        data-pswp-height="{{ $img.Height }}"
        data-pswp-src="{{ $img.RelPermalink }}"
        data-pswp-caption="{{ $.Title }}"
      >
        <img src="{{ $thumb.RelPermalink }}" alt="{{ $.Title }}" style="max-width:100%;height:auto;cursor:zoom-in;" />
      </a>
    </div>
    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"></div>
    <script type="module">
      import PhotoSwipeLightbox from 'https://unpkg.com/photoswipe@5/dist/photoswipe-lightbox.esm.min.js';
      const lightbox = new PhotoSwipeLightbox({
        gallery: '.pswp-gallery',
        children: 'a',
        pswpModule: () => import('https://unpkg.com/photoswipe@5/dist/photoswipe.esm.min.js'),
      });
      lightbox.init();
    </script>
  {{ else }}
    <div style="background:#eee;width:100%;height:300px;display:flex;align-items:center;justify-content:center;">No image found</div>
  {{ end }}
  {{ with .Content }}
  <div class="photo-description">{{ . }}</div>
{{ end }}
{{ end }}
