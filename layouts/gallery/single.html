{{ define "main" }}

<link rel="stylesheet" href="https://unpkg.com/photoswipe@5/dist/photoswipe.css">
<script src="https://unpkg.com/photoswipe@5/dist/photoswipe-lightbox.esm.min.js" type="module"></script>

<link rel="stylesheet" href="/css/gallery-grid.css">
<nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-list">
    <li><a href="{{ .Site.Home.RelPermalink }}">Home</a></li>
    <li style="margin:0 0.5em;">/</li>
    <li><a href="{{ (site.GetPage " section" "gallery" ).RelPermalink }}">Gallery</a></li>
    {{ with .CurrentSection }}
    <li style="margin:0 0.5em;">/</li>
    <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
    {{ end }}
  </ol>
</nav>
<article>

  <h1 class="page-header">{{ .Title }}</h1>
  {{ with .Resources.Match "*.jpg" }}
  {{ $img := index . 0 }}
  {{ $webp := $img.Process "webp" }}
  {{ $thumb := $webp.Fit "800x800" }}
  <div class="pswp-gallery">
    <a href="{{ $img.RelPermalink }}" data-pswp-width="{{ $img.Width }}" data-pswp-height="{{ $img.Height }}"
      data-pswp-src="{{ $img.RelPermalink }}" data-pswp-caption="{{ $.Title }}">
      <img src="{{ $thumb.RelPermalink }}" alt="{{ $.Title }}" style="max-width:100%;height:auto;cursor:zoom-in;" />
    </a>
  </div>
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"></div>
  <script type="module">
    import PhotoSwipeLightbox from 'https://unpkg.com/photoswipe@5/dist/photoswipe-lightbox.esm.min.js';
    const lightbox = new PhotoSwipeLightbox({
      gallery: '.pswp-gallery',
      children: 'a',
      pswpModule: () => import('https://unpkg.com/photoswipe@5/dist/photoswipe.esm.min.js'),
    });
    lightbox.init();
  </script>
  {{ else }}
  <div class="gallery-thumb gallery-thumb-placeholder">No image found</div>
  {{ end }}
  {{ with .Content }}
  <div class="photo-description">{{ . }}</div>
  {{ end }}
  
  {{ with .Params.buy_link }}
    <div class="buy-photo-btn-wrap">
      <a href="{{ . }}" target="_blank" rel="noopener" class="buy-photo-btn">Buy Print</a>
    </div>
  {{ end }}
  {{- if (and site.Params.ShowShareButtons (ne .Params.disableShare true)) }}
    {{- partial "share_icons.html" . -}}
  {{- end }}
  {{ end }}
